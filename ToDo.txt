Регулярно проверять обновление компонента ESP-MODBUS!!!
Несколько раз уже спасало от больших потерь времени!

Создать резервный IP адрес для аварийного перехода при ошибке.
(добавить параметры в веб-морду и конфигурацию)
Заполнять очередь 101 только по условию переполнения ошибки очереди 104 ???

Отключить программно модуль WiFi (Power Manage API)
I (35) boot: ## Label            Usage          Type ST Offset   Length
I (36) boot:  0 nvs              WiFi data        01 02 00009000 00004000
Эти 16К можно использовать для user space data!


Увеличить размер архива событий.
Добавить событие подключения и отключения IEC-101/104 мастера к устройству.
Добавить событие перезагрузка - переход на резервный канал IEC-101/104.
Добавить счетчики ошибок (с возможностью сброса).

Ethernet: уточнить скорость подключения (по возможности установить 100)

Новое железо:
OUTPUT_PIN:
#define GPIO_ETH_LED 2
#define GPIO_RS_LED_RX 4
#define GPIO_RS_LED_TX 23
INPUT_PIN:
#define CONFIG_BUTTON 35

Internal EMAC
Ethernet PHY Device
RTL8201/SR8201 (EBT205)
SMI MDC GPIO number (18)
SMI MDIO GPIO number (5)
PHY Reset GPIO number (14)
PHY Address (1, ?2)
Reduced Media Independent Interface (RMII)
RMII clock mode: Input RMII clock from external

IEC60870_QRP_GENERAL_RESET перезагрузка устройства по этой команде?

WDT реализовать и проверить!!!

Необходимо проконтрольровать тип соединения serial/TCP при добавлении канала
на старой форме веб морды. (REFRESH!)

Запись серийника при выходе из производства - по кнопке коррекции времени (активация редактирования и записи)
Не забыть указать в инструкции по прошивке на производстве!

Включить в инструкцию по настройке:
Каждый новый адрес подчиненного устройства образует новый сокет, даже если этот
адрес физически принадлежит устройству и находится на том же IP адресе.
Максимально возможно подключить 8 сокетов TCP ModBus!!!
(всего допускается 10 сокетов, один занят каналом IEC-104)
В одной физической сети Modbus (serial / ethernet) действует общее адресное
пространство. Поэтому устройства с одним адресом UID будут считаться одним устройством.
Сокет устройства будет действовать тот, который был первым при регитсрации. Это особенность компонента esp-modbus!!!

Время реконнекта по TCP соединению MB посмотреть в конфигурации и установить минимальным!!!

Ограничить создание некорректных конфигураций в веб-морде (типа аварийные значения)
и т.п на регистрах ячейках RO... Для дискретных - логические уровни!
Значения выходов при аварии для дискретных ограничить (true/false ON/OFF) в веб-морде визуально
Установить проверку на возможность записи перед установкой аварийного значения в
веб-морде и коде МК

During booting, the strapping pin MTDO can be used to control the U0TXD Printing, as Table 7 shows.
Table 7: U0TXD Printing Control
U0TXD Printing Control MTDO
Enabled 1 1
Disabled 0
he real solution is to pulldown GPIO15 so that even those bootup logs at UART0
can be stopped and now you're free to use the GPIO 1&3 for I/O operations. 
I confirm that pulling down GPIO15 stops the bootloader
from sending logs to UART0 (GPIO 1 & 3).
GPIO15 подтянуть на GND резистором 1К (910 Ом) 
Не забывать отключать на рабочей конфигурации вывод INFO/DEBUG на UART DBGU

При подключении конверторов RS485 на выход TX следует установить поддтяжку к земле
не менее 4.7К. На CONFIG_MB_UART_TXD=5 уже висит примерно такое, поэтому ничего не
добавлял. На выход CONFIG_MB_UART_TXD=2 обязательно установить!!!

Пересобрать драйвер 101 с новыми исходниками базы?

Добавить обработку на ошибку пакета IEC в функции ParseMessage?
При ошибке отравки пакета производить повторную отправку...

Active Termination проверить реализацию!

Ресетить временные метки при разрыве соединения по 101/104

/* Set mode to a single redundancy group
* NOTE: library has to be compiled with CONFIG_CS104_SUPPORT_SERVER_MODE_SINGLE_REDUNDANCY_GROUP enabled (=1)
*/
CS104_Slave_setServerMode(slave, CS104_MODE_SINGLE_REDUNDANCY_GROUP);
Возможно в этом режиме потребляет меньше ресурсов по оперативке.

Endian Swap добавить к параметрам IEC ???
Возможно добавить в МВ переменную, сдвинув в старшую тетраду.
В веб морде в шапке смтолбца добавить галку выбора драйвера MB/IEC

Реализовать короткий импульс/длинный импульс (определен на КП);

Сравнивать обновленный репозитарий исходников IEC-104 и MODBUS с проектом !!!
Следует обновить до последней версии с КОРРЕКЦИЕ КОДА (пока не менял!):
cs101_slave.c cs101_slave.h
cs104_slave.c cs104_slave.h
link_layer.c link_layer.h
